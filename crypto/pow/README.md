---
title: pow
level: medium
flag: FLAG{p0wp0wp0wp0w}
writer: IK
---

# pow

## 問題文

Not “Proof of Work”

## 解法

RSA暗号の脆弱性をつく問題。

今回の場合はRSA暗号の公開鍵eが非常に小さいときに利用することができる攻撃「Low Public-Exponent Attack」を使用する。

```python
e = 3
c = pow(pow(pow(pow(bytes_to_long(flag),e,n),e,n),e,n),-1,n)
```

上記がeの生成と暗号文cの生成の部分。

まず、eが非常に小さいことがわかる。

暗号文の生成を数式で表すと下記になる。

$$ c \equiv m^{-3^3} \pmod{n}$$

平文を-27乗しているということがわかる。

これでもまだeが非常に小さいため、「Low Public-Exponent Attack」を利用することができる。

逆数は逆数をかけ直すことでもとに戻す。

攻撃の詳細については下記の記事がおすすめ。

[RSA 暗号を理解して有名な攻撃を試してみる](https://zenn.dev/anko/articles/ctf-crypto-rsa#%E3%81%8C%E5%B0%8F%E3%81%95%E3%81%99%E3%81%8E%E3%81%A6%E3%81%AF%E3%81%84%E3%81%91%E3%81%AA%E3%81%84-(low-public-exponent-attack))

## solver
```python
import gmpy2
from Crypto.Util.number import *

n = 832996564959760976823195241369036874331930836728087744536557712534268758407210844397318465111274937735608177904388673624214199725466112865913658434995056758617893416146738789244560645480693761650555452145417373022656073636509975757558533929212693073010240835577668663862110650331663621522632029066604001608679860187780880428356984998804776170584125759195027257746426876634462537399534557175458846127669938361143176408894422233692887183771609437013596861191165178360692751725359572759866548238405263847988841001651961674033885592600946485547208715748258301553558109912812150329393643732352971111679675726063105632765692271592423080233651456108639970299595693598613231239801063903573075734612106087912314081712225092451461217723056254835139645111525573214744589583796462214613329158656819495705405397141116676913364608174122526802177011274209779180902679853926069233723117954503516124963116211752312176303544030671661332858588584790506343593298612857710476468473011968842290990237137197021422496630477106206634599820992398336194454553368198828491063734484505830311730984485659740434980635242119928484356574958521353927153267881888577219655416708001725608189092871205825744442392178367369869325066568397374052340711256217931236499197767
e = 3
c = 316741640014194575297778465204998957406369590310097930350107434509189342323087258023628711552499490064704769444751049023304085971734056534821556748686263668575517610726735254595535342698426527888653741130477751417569027714896553264725137628048721129097206306370098336458618855929920964465759913799114314876427040433906507257767601896083290478567304283269182075731759950830277943950769424428416129761560973318337700083370647888654903851738821358926708037577574683219751461794578864352787385155578862042798560279711240506892922059703174951742576896678437704082404578590458354664856617194893889491977431333280667546743136612034283488192331123539144191183069405405015324629930946406197358987261496998010800402338201345334120070899246186818667816362810197749795297281910991300242412398509351866267129399381516712221188980179985666347024765206657461177660648245988058677188231979251796508905082730374031801041966726953256006539748703908954295147354567066300930050668954644398723612364180925970802769870110590297894222642541339633825480167563884415384934064323148896014656231073210559342714163091664164559117067778555116082660480362441611362340740154062816754756158875391540651321813462427341241570891546132179744209698944958960942834387569

c = pow(c,-1,n)
m = gmpy2.iroot(c,e**3)
print(long_to_bytes(m[0]))
```
